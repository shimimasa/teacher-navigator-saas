# 2025-01-22 診断データモデルと質問管理

## 実施内容

### 1. Diagnosisモデル（models/Diagnosis.js）

#### 主要機能
- ユーザーの診断回答と結果を保存
- MBTI型パーソナリティタイプの管理
- セッション情報とメタデータの記録
- 診断の進捗管理と信頼性検証

#### 実装メソッド
- `getResultSummary()` - 診断結果のサマリー取得
- `calculateCategoryScores()` - カテゴリー別スコア計算
- `getUserDiagnosisHistory()` - ユーザーの診断履歴取得
- `getPersonalityTypeStats()` - パーソナリティタイプ統計

### 2. TeachingStyleモデル（models/TeachingStyle.js）

#### 主要機能
- 8つの授業スタイルタイプの定義
- パーソナリティタイプとの関連付け
- 教授法、特徴、強みの管理
- 使用統計とレーティング機能

#### 実装メソッド
- `getSummary()` - スタイルの概要取得
- `getRecommendationScore()` - 推奨度スコア計算
- `findByPersonalityType()` - パーソナリティタイプ別検索
- `getPopularStyles()` - 人気スタイル取得

### 3. 診断質問データ（data/diagnosisQuestions.json）

#### 質問構成
- 合計40問（各カテゴリー10問）
- 4つのカテゴリー：
  - 外向性 (Extroversion) - E/I判定
  - 感覚 (Sensing) - S/N判定
  - 思考 (Thinking) - T/F判定
  - 判断 (Judging) - J/P判定
- 5段階評価（1:全く当てはまらない〜5:非常に当てはまる）

### 4. 授業スタイルデータ（data/teachingStyles.json）

#### 定義された8つのスタイル
1. **構造化ファシリテーター型** - 明確な枠組みで主体的学習を促進
2. **創造的探求者型** - 創造性と好奇心を引き出す
3. **体系的指導者型** - 段階的で体系的な教授
4. **共感的メンター型** - 個別ニーズに寄り添う支援
5. **ダイナミック実演型** - エネルギッシュな実演型授業
6. **分析的コーチ型** - データと論理に基づく指導
7. **協働的組織者型** - 学習コミュニティ構築
8. **実践的実証型** - 体験を通じた実用的学習

### 5. 診断エンジン（services/diagnosisEngine.js）

#### 主要機能
- MBTI型パーソナリティタイプの判定
- カテゴリー別スコアの計算（60%閾値）
- 強みと課題の特定
- 推奨授業スタイルの決定
- 回答の信頼性検証

#### 信頼性検証機能
- 回答の一貫性チェック
- 回答時間の妥当性検証
- 回答パターン分析（極端な回答、連続同一回答）

### 6. データシーダー（utils/seeder.js）

#### 機能
- 授業スタイルデータの投入
- サンプル診断データの生成（開発用）
- コマンドラインオプション：
  - `--styles` - 授業スタイルデータ投入
  - `--samples` - サンプル診断データ生成
  - `--all` - すべてのデータ投入

### 7. テストの実装

#### Diagnosisモデルテスト
- 診断データの作成と検証
- 進捗率計算のテスト
- カテゴリースコア計算
- 診断履歴取得

#### DiagnosisEngineテスト
- パーソナリティタイプ判定の正確性
- スコア計算の検証
- 推奨スタイルのマッピング
- 信頼性検証機能のテスト

## 技術的決定事項

### MBTI型診断の実装
- 各カテゴリー60%以上で該当特性と判定
- 4つの軸（E/I, S/N, T/F, J/P）の組み合わせで16タイプ
- 日本の教育現場に特化した質問設計

### スコアリング
- 5段階評価を0-100%に変換
- カテゴリー内の平均値を使用
- 未回答カテゴリーは50%（中立）

### データ構造
- 診断履歴の保存で成長追跡可能
- セッション情報で診断の質を評価
- 推奨スタイルとの関連付けで実用的提案

## 次のステップ
- 診断APIエンドポイントの実装（タスク3.2）
- 診断フローの完成